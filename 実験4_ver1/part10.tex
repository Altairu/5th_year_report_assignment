% !TEX root = main.tex

\section{シーケンス制御の基礎実習}

\subsection{実験目的}
シーケンス制御とは,あらかじめ決められた順序または手続きに沿って制御の各段階を逐次進めていく
制御方法のことで,例えば炊飯器の制御が該当する.炊飯器の場合は,
予約設定から炊き上がりおよび時間を予約設定を行うまでの流れがあらかじめ決められており,
一方向にしか制御は進まない.

ひとつの作業を終了することで,次の作業に移ることから,
そのような制御方法を順序制御と呼ぶ.他に,時間によって作業を切り替える時間制御,
あらかじめ決められた作業の中から現在の条件に見合う作業を選択する条件制御など,
シーケンス制御の内部にして様々な制御方法が存在する.

\begin{itemize}
  \item 順序制御の例：自動販売機
  \item 時間制御の例：信号機
  \item 条件制御の例：洗濯機
\end{itemize}

本実験では,FAシステムを構築する前の準備訓練として,
オムロン株式会社寄贈のベーシックFAキットを用いて
シーケンス制御の基礎を学習することを目的とする.

\subsection{実験装置の概要}

本実験では,ベーシックFAキットを使用する.
また,このベーシックFAキットには拡張パーツボックスが付いている.
これらのパーツ（センサーやタイマー等）についての詳細は次章で述べる.

図1.4にベーシックFAキットの内部配線図を示す.
FAキットの入力はAC 100 [V]とし,内部のパワーサプライによってDC 24 [V]に変換されている.
よって,以降で使用するパーツ（センサーやタイマー等）はDC 24 [V]駆動の製品である.

キット本体は主に,タイマの調整スイッチ,SW1〜SW4までの4つの押しボタンスイッチ,
コンベア制御用の切り替えスイッチ,L1〜L3までの表示灯,およびコンベアで構成されている.
ただし,SW4だけスイッチの種類が違うことに注意すること.

次に,このベーシックFAキットの基本的な使用方法について,最も単純な使用例を挙げて説明する.
例えば以下の手順に従い,SW1を押せばL1が点灯する機能を作ることにする.
\begin{enumerate}
  \item まず,背面に入っているコネクトを接続し,クレーターを上げる.
  \item 次に「+24V端子とスイッチ1」,「スイッチ1と表示灯1」そして「表示灯1と-V」を各ケーブルで接続する.
  \item 最後に電源を入れスイッチ1を押せば表示灯1が点灯する.
\end{enumerate}

なお,赤いリード線が+24Vに対応することを推奨するが,配線の見直し時に便利なため,
-Vには青,それ以外は黄を使うことを推奨する.

\subsection{シーケンス制御に必要な電子機器}

本章では,シーケンス制御に必要な電子機器について述べる.ただし,これらの知識があるならば,本章を読み飛ばして次章に移っても差し支えない.

\subsubsection{スイッチとリレー}
本実験の基礎となるのはリレーシーケンス制御である.
リレーを用いたシーケンス制御のことをリレーシーケンス制御と呼び,
通常シーケンス制御といえばこれを意味する.
リレーとは「電流によって制御可能なスイッチ」のことで,
これを用いることで回路内の電流の進行方向を制御し,出力先を任意に設定することが可能である.

リレーの種類としては,有接点リレーと無接点リレーが挙げられる.
有接点リレーは,主に電磁リレーのことを指し,電流によって磁力を生じさせてスイッチをON/OFFさせる.
一方,無接点リレーは,ダイオード,トランジスタなどの半導体を用いてON/OFFを行うものである.
また,無接点リレーを用いた制御では論理演算を行うために論理シーケンス制御と呼ばれる.
しかし,扱える電流・電圧の範囲が狭く,直接接続制御には不向きである.
また,PLCが主流である現在では,回路の変更が容易でない,などの理由から利用される機会は少なくなっている.
本実験でもリレーは基本的な有接点リレーを用いることにする.

\paragraph{a 接点スイッチ}
a接点スイッチとはボタンを押しこむことで端子間が導通するスイッチのことであり,
通常時は接続（開放）されているNO (Normally Open) 接点ともいわれる.
ボタンを押している時だけ導通し,離せば接続されることに注意すること.

\paragraph{b 接点スイッチ}
b接点スイッチとはボタンを押しこむことで端子間が絶縁するスイッチのことであり,
通常時は導通しているNC (Normally Close) 接点ともいわれる.ボタンを押している時だけ端子間は開放され,
離せば導通することに注意すること.

\paragraph{c 接点スイッチ}
c接点とはa接点とb接点の両方の特性を併せ持つスイッチである.
通常はb接点とCOM (common),押しこむことでa接点とCOMが導通することになる.
リレーでは,このc接点の機能を備えているものが多く用いられている.
本実験で使用するリレーもc接点を持っている.また実験で使用するマイクロスイッチもc接点である.

\paragraph{リレー}
電磁コイルに電流を流すことで磁界が発生し,可動鉄片に磁力がかかる.
それによって,可動鉄片がb接点から離れ,a接点と切り替え接点(COM)が導通する.
また,電磁コイルに電流を流すことを止めると,伸ばされていたバネによる力でa接点から離れ,
元のb接点と再び導通する.このようにリレーは,電流を流すことでON/OFF（a接点とb接点の切り替え）
が可能なスイッチの機能を持つ素子である.

リレーの端子において端子9〜12がCOMとなっており,端子1〜4がNC,端子5〜8がNOの役割を持つ.
端子14に+24V,端子13に-Vを入力するとリレーがONとなり,COMとNO端子が導通する.
なお,リレーは接続端子が付いたソケットに挿入して用いることで配線が容易となる.

\subsubsection{タイマ}
タイマとは,設定した時間を作り,その設定時間後に内蔵スイッチ（リレー）を切り替える機器のことである.
端子の配線についてはリレーと同様である.

また,本実験で使用するタイマH3YNには側面に4つのディップスイッチが付いている.
上2つのディップスイッチでタイマ時間の単位（1s, 10s, 1min, 10min）を変更することができる.
また下2つのディップスイッチで4つの動作モードが設定可能である.

\subsubsection{カウンタ}
カウンタとは数を数える機能を持った機器のことであり,設定値に達することで出力する機能を併せ持つ.
各端子の役割が設定されており,6番と9番が導通するとカウントアップ,6番と7番が導通するとリセットとなる.
また,3番はCOMの役割を持ち,設定値にカウント数が達するとNOの4番と導通,NCの5番が絶縁する.
タイマ同様,側面のディップスイッチによって動作の設定が可能である.
ただし,本実験では特に設定変更は必要ない.

\subsection{近接センサ}
近接センサとは,磁界や電界を利用して近づく金属に反応するセンサのことである.
茶色のケーブルに24 V,青色に0 Vを接続して動作させる.検知信号は,黒ケーブルから取り出せるが,
負荷（例えば表示灯）の0 V側と接続して用いる.

\subsubsection{光電センサ}
光電センサとは,可視光線や赤外線などの光を利用するセンサであり,応答速度が速い,
検出距離が長いなどの特徴を持つ.本実験で用意している光電センサには透過形,
回帰反射形,拡散反射形の三種類がある.

\begin{figure}[h]
  \centering
  \includegraphics[scale=0.7]{sozai/13.pdf}
  \caption{光電センサの種類}
\end{figure}

\subsection{シーケンス制御の基礎理論・シーケンス回路図}

本節では,シーケンス制御の基礎理論となるシーケンス回路図について述べる.
ただし,シーケンス制御についての知識があるならば,次章の実験内容に移っても差し支えない.

シーケンス回路図は制御における論理回路を表すものであり,電気回路図とは異なっており
,シーケンス回路図（あるいはリレー回路図など）と呼ばれる図面に対応する.
シーケンス回路図の基本となるシンボルは,これに応じた装置の動作方法が存在することを留意すること.

ここで,コイルの記号について少し詳しく述べておく.リレーのコイルとは,リレーの動作電源となる端子13, 14番のことである

また,タイマの出力はリレーと同様に接点やコイルを持っている.

\subsubsection{例題によるシーケンス回路図解説}
指導書図1.22にシーケンス回路図の例を示す.
SWは押しボタンスイッチ,Rはリレー,OUTは出力（例えば表示灯）を意味する.

この回路の動作は,SWを押すことでリレーのコイル（電磁リレーの場合）に電流が流れ,
磁力に反応してa接点がONとなりOUTに出力される.通常,電流は流れ続けるが,
左側が開閉しない限りGNDと考えスムーズな動作を行う.なお,図中の記号において接点は上が下,
下が上と直線的に作動する.

\subsubsection{シーケンス回路図における注意点}
シーケンス回路図を作成する上で以下のことに注意が必要である.
\begin{itemize}
  \item 出力,コイルの後には何も設置しない
  \item 出力,コイルを直列に設置しない
  \item 接点なしで直接出力しない
  \item 短絡させない
\end{itemize}

\subsection{実験内容}

本実験では,「シーケンス制御の基礎実習」を行う.以下に記載する実験1-5および,
課題1-1から1-7までを実施する.なお,実験報告書ではなく,
レポートには各課題のシーケンス回路図を書いて提出すること.
ただし,本指導書では簡略化のためシーケンス回路図はJIS規格に統一している.

\subsubsection{実験1-1 リレー}
図1.2に示す回路で,リレーの接点の動きを確認せよ.
ただし,リレーはソケットに装着し,ソケットはDINレールに差し込むこと.

\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{sozai/1_compressed.pdf}
  \caption{リレー}
\end{figure}


\paragraph{課題1-1 自己保持回路}
a接点スイッチだけではスイッチを押したときに出力はOFFとなってしまう.
SW1をONするとランプが点灯し,SW2をONにすると消灯する回路（自己保持回路）を作成せよ.\\
ヒント: SW1はa接点,SW2はb接点である.リレーを用いる.

\subsubsection{実験1-2 タイマ回路}
図1.3に示す回路で,電源を入れてからランプが点灯するまでの時間を計測し,
タイマ（型番: H3YN）の動作確認を行いなさい.ただし,タイマはソケットに装着し,
タイマ側面のモードをオンディレイに設定し,TIME RANGEは10sとする.
ディップスイッチはマイナスドライバーで設定すること.また,TIME RANGEを10sと変更し動作確認を行いなさい.
なお,設定時間は任意,自己保持せずにスイッチは押し続けてよいものとする.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/2.pdf}
  \caption{タイマ回路}
\end{figure}

\subsubsection{実験1-3 タイマのモード}
タイマの各モードの動作を確認しなさい.
回路は実験1-3と同じでも構わない.

\paragraph{課題1-2 タイマ利用}
スイッチを一度押すとランプが点灯し，5秒後に自動消灯する回路を作成せよ.

\paragraph{課題1-3 タイマ利用}
スイッチを一度押すことでランプを２つを自動で交互に点灯させる回路を作成せよ．

\subsubsection{実験1-4 カウンタ回路}
図1.4に示す回路で,カウンタの動作確認を行いなさい.例えば,カウンタの設定値を5に設定後,
設定した値（5回）スイッチを押すたびにセンサが点灯するような回路を作成せよ.
また,リセットスイッチの効果を確認すること.\\
（注意）カウンタのピン番号の位置が実機とは異なる場合がある旨,表示に従って結線すること.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/3.pdf}
  \caption{カウンタ回路}
\end{figure}

\paragraph{課題1-4 カウンタとタイマ}
1秒につき1カウントする回路を作成せよ.ただし,起動には押しボタンスイッチを用いた自己保持回路を用いる.
また,カウンタのリセットについては考えなくてもよいものとする.
各機器のモードは適切なものを選択すること.\\
ヒント: タイマを用いる.

\subsubsection{実験1-5 センサを用いた回路}
図1.5に示す回路で,センサの動作確認を行いなさい.コンベアは「手動」に設定し,
角型9V乾電池とコンベアで運転しランプの点灯を確認する.センサは光電センサの中から好きなものを選んで,
コンベア周辺に取り付けること.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/4.pdf}
  \caption{センサを用いた回路}
\end{figure}

\paragraph{課題1-5 オートリセット回路}
設定数に達するとリセット入力を行うオートリセット回路を作成せよ.
カウンタの出力モードはNモードを用いること.また,カウンタは補助電極ON（自己保持回路は不要）とし,
カウントアップには押しボタンスイッチを用いること.

\paragraph{課題1-6 センサとカウンタ}
センサを用いたアップカウンタ回路を作成せよ.ただし,センサ,
カウンタ共に補助電極ON（自己保持回路は不要）とする.また,センサの選択は任意とする.
実験結果は実験1-8と同様に数値を記録するものとする.

\paragraph{課題1-7 複合回路}
センサ,リレー,タイマを用いて,コンベアでワークを運搬しセンサにかかるとコンベアを停止させ,
5秒後にコンベアを動き始める回路を作成せよ.


\newpage

\subsection{実験結果および考察}

本実験では,「シーケンス制御の基礎実習」を行う.以下に記載する実験1-5および,
課題1-1から1-7までを実施した．

\subsubsection{実験1-1 リレー}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/1_compressed.pdf}
  \caption{リレー}
\end{figure}

\begin{enumerate}
  \item 初期状態では，NOスイッチが開いており，リレー(R)に電源が供給されていないため，リレーのNC接点が閉じ，L1が点灯している．一方，リレーのNO接点は開いており，L2は消灯している．
  \item NOスイッチを押すと，リレー(R)に電源が供給されて動作を開始する．これにより，リレーのNC接点が開き，L1が消灯する．同時に，リレーのNO接点が閉じ，L2が点灯する．
  \item NOスイッチを再び離すと，リレー(R)への電源供給が停止し，リレーが元の状態に戻る．これにより，リレーのNC接点が閉じ，L1が再び点灯する．一方，リレーのNO接点が開き，L2が消灯する．
\end{enumerate}


\paragraph{課題1-1 自己保持回路}
a接点スイッチだけではスイッチを押したときに出力はOFFとなってしまう.
SW1をONするとランプが点灯し,SW2をONにすると消灯する回路（自己保持回路）を作成せよ.\\

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{sozai/14.pdf}
  \caption{課題1-1}
\end{figure}

\begin{enumerate}
  \item 初期状態ではSW1が開いており, リレー(R)は動作していないため, ランプは消灯している.
  \item SW1を閉じると, リレー(R)に電流が流れ動作する. リレーの接点が閉じて自己保持回路が形成される. この状態でSW1を開いても, リレーは動作を維持し, ランプは点灯したままとなる.
  \item ランプを消灯させるにはSW2を閉じる必要がある. SW2を閉じると, 自己保持回路が断ち切られ, リレー(R)への電流が停止する. リレーが動作を解除し, ランプが消灯する.
\end{enumerate}

\subsubsection{実験1-2 タイマ回路}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/2.pdf}
  \caption{タイマ回路}
\end{figure}

\begin{enumerate}
  \item 初期状態で, NOスイッチが開いている場合, タイマ(T)に電源が供給されないため, ランプL2は消灯している.
  \item NOスイッチを押すと, タイマ(T)に電源が供給され, タイマが動作を開始する. タイマは設定された遅延時間 (ここでは10秒) が経過すると, 出力接点を閉じる.
  \item タイマの接点が閉じると, ランプL2が点灯する.
\end{enumerate}

\subsubsection{実験1-3 タイマのモード}

インターバルモード
\begin{enumerate}
  \item NOスイッチを押すと, タイマ(T)に電源が供給され, タイマが動作を開始する.
  \item タイマの接点が閉じ, ランプL2が点灯する.
  \item タイマの設定時間 (ここでは10秒) が経過すると, タイマの接点が開き, ランプL2が消灯する.
  \item NOスイッチを押し続けても, タイマの設定時間が経過後はランプL2が消灯したままとなる.
  \item NOスイッチを再び離してから押すと, タイマがリセットされ, 再び動作を開始する.
\end{enumerate}

フリッカーオフスタート
\begin{enumerate}
  \item NOスイッチを押すと, タイマ(T)に電源が供給され, タイマが動作を開始する.
  \item タイマは最初に接点を開いた状態からスタートし, 設定時間 (ここでは10秒) が経過すると接点を閉じる.
  \item 接点が閉じるとランプL2が点灯し, 設定時間が経過すると接点が再び開き, ランプL2が消灯する.
  \item この動作を電源が供給されている間繰り返す.
\end{enumerate}

フリッカーオンスタート
\begin{enumerate}
  \item NOスイッチを押すと, タイマ(T)に電源が供給され, タイマが動作を開始する.
  \item タイマは最初に接点を閉じた状態からスタートし, 設定時間 (ここでは10秒) が経過すると接点を開く.
  \item 接点が開くとランプL2が消灯し, 設定時間が経過すると接点が再び閉じ, ランプL2が点灯する.
  \item この動作を電源が供給されている間繰り返す.
\end{enumerate}


\paragraph{課題1-2 タイマ利用}
スイッチを一度押すとランプが点灯し，5秒後に自動消灯する回路を作製した．
\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/15.pdf}
  \caption{課題1-2}
\end{figure}

\begin{enumerate}
  \item 初期状態では，SW1が開いており，リレー(R)とタイマ(T)には電源が供給されていないため，ランプ(L1)は消灯している．
  \item SW1を押すと，リレー(R)が動作して自己保持回路が形成される．これにより，ランプ(L1)が点灯する．
  \item リレーの動作によりタイマ(T)が起動し，設定された時間（5秒）が経過すると，タイマの接点が導通してリレーがリセットされる．
  \item リレーがリセットされることで自己保持回路が解除され，ランプ(L1)は自動的に消灯する．
\end{enumerate}


\paragraph{課題1-3 タイマ利用}
スイッチを一度押すことでランプを２つを自動で交互に点灯させる回路を作成した．
\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/16.pdf}
  \caption{課題1-3}
\end{figure}

\begin{enumerate}
  \item 初期状態では，SW1が開いており，リレー(R)およびタイマ(T)に電源が供給されていないため，ランプL1およびL2は消灯している．
  \item SW1を押すと，リレー(R)が動作して自己保持回路が形成される．これにより，タイマ(T)が動作を開始する．
  \item タイマ(T)の設定時間が経過すると，タイマの接点が導通し，以下の動作が順次行われる:
  \begin{enumerate}
      \item ランプL1が点灯し，ランプL2は消灯する．
      \item 次にタイマが再び動作を開始し，設定時間が経過すると，ランプL1が消灯し，ランプL2が点灯する．
  \end{enumerate}
\end{enumerate}


\subsubsection{実験1-4 カウンタ回路}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/3.pdf}
  \caption{カウンタ回路}
\end{figure}

\begin{enumerate}
  \item 初期状態では, カウンタの設定値を5に設定する.
  \item 9に接続されたNOスイッチを1回押すごとにカウンタのカウント値が1ずつ増加する.
  \item カウント値が設定値 (5回) に達すると, カウンタの接点が導通し, ランプLが点灯する.
  \item ランプLが点灯している状態で, ７に接続されたリセットスイッチを押すとカウンタがリセットされ, カウント値が0に戻る. これにより, ランプLが消灯する.
  \item 再びNOスイッチを押すことで, カウンタが再度動作を開始し, 上記の動作を繰り返す.
\end{enumerate}


\paragraph{課題1-4 カウンタとタイマ}
1秒につき1カウントする回路を作成した．

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/17.pdf}
  \caption{課題1-4}
\end{figure}

\begin{enumerate}
  \item 初期状態では，SW1が開いており，リレー(R)，タイマ(T)，およびカウンタには電源が供給されていないため，ランプ(L)は消灯している．
  \item SW1を押すことでリレー(R)の自己保持が起動し，タイマ(T)に電源が供給される．
  \item タイマ(T)はフリッカーオフスタートモードで動作しており，タイマの接点が1秒周期でON/OFFを繰り返す．
  \item タイマの接点がONになるたびにカウンタに入力信号が送られ，カウンタが1カウント増加する．これにより，SW1を押してから1秒後にカウントが開始され，その後も1秒間隔でカウントが行われる．
  \item カウンタのカウント値が設定値に達すると，カウンタの出力接点が閉じ，ランプ(L)が点灯する．
  \item SW1を再び押してリレーの自己保持を解除すると，リレー(R)がリセットされ，タイマ(T)およびカウンタもリセットされる．これにより，ランプ(L)は消灯する．
  \item 上記の動作を繰り返すことで，SW1の操作に応じて1秒ごとにカウントし，設定値に達した際にランプを点灯させることができる．
\end{enumerate}


\subsubsection{実験1-5 センサを用いた回路}
図1.5に示す回路で,センサの動作確認を行いなさい.コンベアは「手動」に設定し,
角型9V乾電池とコンベアで運転しランプの点灯を確認する.センサは光電センサの中から好きなものを選んで,
コンベア周辺に取り付けること.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{sozai/4.pdf}
  \caption{センサを用いた回路}
\end{figure}

\begin{enumerate}
  \item センサーが反応すると，ランプのグランドが-Vに接続され，光る．
\end{enumerate}

\paragraph{課題1-5 オートリセット回路}
設定数に達するとリセット入力を行うオートリセット回路を作成した．

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{sozai/18.pdf}
  \caption{課題1-5}
\end{figure}
\begin{enumerate}
  \item 初期状態では, カウンタのカウント値は0であり, 接点は開いている.
  \item スイッチが動作してカウント入力が発生するたびに, カウント値が1ずつ増加する.
  \item カウント値が設定値に達すると, カウンタの接点が一時的に導通する.
  \item 接点の導通により, リセット回路が動作してカウンタが自動的にリセットされ, カウント値が0に戻る.
  \item 上記の動作を繰り返すことで, 設定値に達するたびに自動リセットが行われる.
\end{enumerate}



\paragraph{課題1-6 センサとカウンタ}
センサを用いたアップカウンタ回路を作成した．

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{sozai/19.pdf}
  \caption{課題1-6}
\end{figure}
\begin{enumerate}
  \item 初期状態では, センサ(S)が検出を行っていないため, カウンタには入力がなく, 接点は開いている.
  \item センサ(S)が検出を行うたびに, カウンタが1カウントを増加する.
  \item カウントが設定値に達すると, カウンタの接点が導通する.
  \item リセットスイッチが押されると, カウント値がリセットされ, 接点が再び開く.
  \item センサ(S)の検出とリセットスイッチの操作により, 上記の動作を繰り返すことができる.
\end{enumerate}



\paragraph{課題1-7 複合回路}
センサ,リレー,タイマを用いて,コンベアでワークを運搬しセンサにかかるとコンベアを停止させ,
5秒後にコンベアを動き始める回路を作成した．

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{sozai/20.pdf}
  \caption{課題1-7}
\end{figure}

\begin{enumerate}
  \item 初期状態では, コンベアのモーター(M)は動作しており, センサ(S)がワークを検出していない.
  \item ワークがセンサ(S)を通過すると, センサが検出信号を出力し, リレー(R)が動作する.
  \item リレーの動作により, タイマ(T)がオンディレイモードで起動する.
  \item タイマ(T)は設定時間 (5秒) を計測し, 時間が経過すると接点が導通する.
  \item タイマの接点が導通すると, リレーがモーター(M)への電源供給を停止し, コンベアが停止する.
  \item 再びリレーがリセットされると, モーター(M)への電源供給が再開され, コンベアが再び動き始める.
  \item 上記の動作をワークがセンサ(S)を通過するたびに繰り返す.
\end{enumerate}



\section{PLCラダープログラムによる回路設計}

\subsection{実験目的}
第1節では,要求する動作に対してハードウェア（必要な部品とリード線）による物理的な結線で命令を実行してきた.
この方式はワイヤードロジックと呼ばれている.一方,要求する動作をプログラミングで実行する方式を
ソフトワイヤードロジックと呼び,この働きを持つ機器をPLC（Programmable Logic Controller）とする.
PLCを用いることで,回路の変更・更新が容易であり,
また回路を実際には作成しないため安価であるという利点がある.
第2節の本実験では,CX-Programmerというソフトウェアを用いてPLCのためのラダープログラムの設計について学ぶ.


\subsection{実験装置（プログラマブルロジックコントローラ）の説明}
PLCは入力部,演算制御部,出力部の3つに大別される.

PLCの主な機能は入出力機能である.例えば,入力部でセンサによる信号を受け,内部CPUで条件判断をし,
出力部のリレーを開閉することで接続されたモータをON/OFFするといった入出力機能を持つ.また,
CPU部でカウンタ,タイマ,内部補助リレー（仮想的なリレー）を有している点も特徴といえる.
表2.1にCPI1-Lの仕様を示す.入力リレーの個数は8点,出力リレーは6点,内部補助リレーは8192点
（正しくは他にもあるが省略する）となっている.これらのリレーにはアドレスと呼ばれる番号が付いている.

\begin{table}[h]
  \centering
  \caption{OMRON CP1L-Lの仕様}
  \begin{tabular}{|c|c|c|}
    \hline
    機能           & 点数    & アドレス       \\ \hline
    入力リレー     & 8点     & 0.00～0.07     \\ \hline
    出力リレー     & 6点     & 100.00～100.05 \\ \hline
    内部補助リレー & 8,192点 & W0.00～W511.15 \\ \hline
    タイマ         & 4,096点 & T0～T4095      \\ \hline
    カウンタ       & 4,096点 & C0～C4095      \\ \hline
  \end{tabular}
\end{table}

アドレスとは,そのリレーの場所を示す番号である.CP1L-Lは上段に入力端子,
下段に出力端子がある.本機では入力端子は0ch,出力端子は100chとあらかじめ決められている.
図2.3に入力端子とアドレスの関係を示す.入力端子は0chであると決まっているので,
アドレスは0.xxとなる.xxには接続する端子ごとに数字（ビット）が割り振ってある.
図2.3の例ではビット01および06なのでアドレスは0.01および0.06となる.

また,本実験ではそれほど多くの内部補助リレーを必要とはしないが,
1chごとのビット数は0～15までであることに注意する.つまり,16個の内部補助リレーW0.00～W0.15を使っていて,
もう1つ以上使いたい場合はW1.00以降となりW0.16は使えないことに注意する.

次に,入力部とCOMの関係について述べる.入力部とはスイッチやセンサなどの入力機器を接続し,
それらのON/OFF情報を取り込む部分である.COMに+24Vを接続し,
a接点をアドレス0.05に接続したとする.入力部の内部構造はフォトカプラとなっており,
入力部の端子とCOMとの電位差が生じることで入力がONと判断されることになる.
COM側が+24Vであってもフォトカプラは作動し,反対に端子側が+24Vであってもよい.ただし,
本実験で用いるセンサの検知信号は0V側と接続して用いる（第1節の1.4章を参考）ため
センサを用いるならばCOMを+24Vにする必要がある.また,センサの種類によって検知信号の電位は異なるという点に注意する.

次に,出力部とCOMの関係について述べる.出力部はランプやモーターなどの出力機器を接続し,
処理結果を外部出力するところである.PLCは内部リレー100.05をONとすることで
COMと端子05を導通させる機能を持つ.このためCOM端子に接続する電圧および方向は,
PLCに接続するモーターなどの出力機器に依存する.しかし,入力部のCOMは1つだけであったが,
出力部のCOMは出力端子ごとに個別となっている.これは出力機器がDC24V駆動であったり,
AC100V駆動であったりと様々であるため,それらに対応するためである.

\subsection{実験内容}

本実験では,「PLCitemizeラダープログラムによる回路設計」を行う.
以下に記載する実験2-1および課題2-1から2-8までを実施する.なお,
課題はラダープログラムを作成して動作確認を行うと共に,レポートにラダープログラム図を添付すること.

\subsubsection*{実験2-1 ラダープログラムの動作確認}
\begin{enumerate}
  \item ベーシックFAキットとPLCを配線する.\\
        PLCのIN端子00, 01, 02にNOスイッチ×3をそれぞれ接続する.\\
        そのNOスイッチを3-V, COMと+24V,およびPLCへの電源を接続する.
  \item 図2.9に示すようにプログラムをCX-Programmerで作成する.\\
        ソフトウェア上でNCの役割を行うことを確認する.
  \item 画面上で内部リレー（アドレスW1.00）が作動していることを確認する.
\end{enumerate}



\begin{figure}[H]
  \centering
  \includegraphics[scale=0.5]{sozai/5.pdf}
  \caption{ラダープログラムの動作確認のPLC}
\end{figure}

\subsubsection*{課題2-1 自己保持回路（課題1-1のラダープログラム）}
SW1をONするとランプが点灯し続け,SW2をONにすると消灯する回路（自己保持回路）を作成せよ.

\subsubsection*{課題2-2 タイマ利用（課題1-2のラダープログラム）}
スイッチを一度押すとランプが点灯し,5秒後に自動消灯するような回路を作成せよ.\\
ヒント：自己保持回路を用いてタイマの起動を制御.

\subsubsection*{課題2-3 タイマ利用（課題1-3のラダープログラム）}
スイッチを一度押すことでランプ2つを自動で交互に点灯させる回路を作成せよ.
ヒント：タイマを2つ使用するプログラムを以下に示す.これを改良して始動スイッチを設けること.

\subsubsection*{課題2-4 カウンタとタイマ（課題1-4のラダープログラム）}
1秒につき1カウントする回路を作成せよ.ただし,
起動には押しボタンスイッチを用いた自己保持回路を用いる.
また,通常のカウンタ（CNT）は減算であるため加減算カウンタ（CNTR）を用いること.
図2.11に示すようにCNTRには加算・減算・リセット信号の3つの信号を入力する必要がある.

\subsubsection*{課題2-5 オートリセット回路（課題1-5のラダープログラム）}
設定数に達するとリセット入力を行うオートリセット回路を作成せよ.ただし,
出力先が指定しないのでCX-Programmer上でカウンタがリセットされていることを確認すること.
条件：自己保持回路は不要とし,カウントアップには押しボタンスイッチを用いること.
カウンタはCNTを用いること.

\subsubsection*{課題2-6 センサとカウンタ（課題1-6のラダープログラム）}
センサを用いたアップカウンタ回路を作成せよ.カウンタには加減算カウンタCNTRを用いる.
また,実験体は実験1-8と同様に乾電池の通った数を数えるものとし,センサの種類は任意とする.
センサ等の起動に自己保持は用いなくてもよいものとする.

\subsubsection*{課題2-7 複合課題}
押しボタンスイッチ1つのみを用いて,一度押すとランプが点灯,
もう一度押すと消灯を繰り返すラダープログラムを作成せよ.
カウンタをCNTを用いた場合のラダーフローの流れを以下に示す.ただし,CNT,
CNTRどちらを用いてもよい.CNTRを使えば,タイマによりリセットの行程を省ける.

\subsubsection*{課題2-8 複合課題}
課題2-7を基に,押しボタンスイッチ1つでランプ2つを交互に点灯させる回路を作成せよ.ただし,
スイッチングする際（点灯する前）に1秒間のタイムラグを与えること.
つまり,
ランプ1点灯（X1秒）→ランプ1消灯→1秒経過→ランプ2点灯（X2秒）→ランプ2消灯→1秒経過→ランプ1点灯
の繰り返しとなる.
ここで,X秒のところは各自が押しボタンスイッチを押す間隔である.
また,スイッチを押すまではランプが点灯していないように工夫せよ.


\subsection{実験結果および考察}

本実験では,「PLCラダープログラムによる回路設計」を行う.
以下に記載する実験2-1および課題2-1から2-8までを実施する.

\subsubsection*{実験2-1 ラダープログラムの動作確認}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{sozai/5.pdf}
  \caption{ラダープログラムの動作確認のPLC}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{sozai/21.pdf}
  \caption{ラダー図}
\end{figure}

\begin{enumerate}
  \item 初期状態では，全てのスイッチ (NOスイッチ) が開いており，ランプ(L1，L2，L3)は消灯している．また，内部リレー(W:1.00)はOFFの状態である．
  \item NOスイッチを1つ押すと，対応する入力(I:00.00，I:00.01，I:00.02)がONになり，対応する出力(Q:100.00，Q:100.01，Q:100.02)がONとなる．さらに，内部リレー(W:1.00)が動作することで，以下の動作が行われる:
  \begin{itemize}
      \item I:00.00がONになると，Q:100.00がONとなり，ランプL1が点灯する．
      \item I:00.01がONになると，Q:100.01がONとなり，ランプL2が点灯する．
      \item I:00.02がONになると，W:1.00がONになり，これをトリガとしてQ:100.02がONになり，ランプL3が点灯する．
  \end{itemize}；０+
  \item 各NOスイッチを離すと，対応する入力がOFFとなり，出力もOFFになるため，ランプ(L1，L2，L3)は消灯する．同時に，内部リレー(W:1.00)もリセットされる．
  \item この動作を繰り返すことで，NOスイッチの操作に応じたランプの点灯および消灯を確認することができる．また，内部リレーを使用することで，複雑な論理動作を簡略化できることが確認できる．
\end{enumerate}


\subsubsection*{課題2-1 自己保持回路（課題1-1のラダープログラム）}
SW1をONするとランプが点灯し続け,SW2をONにすると消灯する回路（自己保持回路）を作成した．

\begin{figure}[H]
  \centering
  \includegraphics[scale=1]{sozai/2-1-crop.pdf}
  \caption{課題2-1}
\end{figure}

\begin{enumerate}
  \item 初期状態では, SW1およびSW2がOFFであり, ランプは消灯している.
  \item SW1をONにすると, 回路が自己保持され, ランプが点灯する. この状態では, SW1をOFFにしてもランプは点灯したままとなる.
  \item SW2をONにすると, 自己保持回路が解除され, ランプが消灯する. この状態では, SW1をONにしてもランプは点灯しない.
  \item SW2をOFFにすると, 再びSW1をONにすることでランプが点灯し, 上記の動作を繰り返すことができる.
\end{enumerate}


\subsubsection*{課題2-2 タイマ利用（課題1-2のラダープログラム）}
スイッチを一度押すとランプが点灯し,5秒後に自動消灯するような回路を作成した．
\begin{figure}[H]
  \centering
  \includegraphics[scale=1]{sozai/2-2-crop.pdf}
  \caption{課題2-2}
\end{figure}

\begin{enumerate}
    \item 初期状態では，押しボタンスイッチ(I:0.00)がOFFであり，内部リレー(T0001)およびタイマ(TIM0001)には電源が供給されていないため，ランプ(Q:100.01)は消灯している．
    \item 押しボタンスイッチ(I:0.00)をONにすると，内部リレー(T0001)が動作し，自己保持回路が形成される．これにより，タイマ(TIM0001)に電源が供給されると同時に，ランプ(Q:100.01)が点灯する．
    \item タイマ(TIM0001)は設定された時間 (5秒) を計測し，タイマが動作時間を経過すると，タイマ接点が開き，内部リレー(T0001)がリセットされる．
    \item 内部リレー(T0001)がリセットされることで自己保持回路が解除され，ランプ(Q:100.01)が消灯する．
    \item スイッチを再び操作することで，上記の動作が繰り返される．
\end{enumerate}


\subsubsection*{課題2-3 タイマ利用（課題1-3のラダープログラム）}
スイッチを一度押すことでランプ2つを自動で交互に点灯させる回路を作成した．
\begin{figure}[H]
  \centering
  \includegraphics[scale=1]{sozai/2-3-crop.pdf}
  \caption{課題2-3}
\end{figure}
 
\begin{enumerate}
  \item 初期状態では，押しボタンスイッチ(I:0.00)がOFFであり，内部リレー(T0000)およびタイマ(TIM0000，TIM0001)には電源が供給されていない．初期状態ではランプ(Q:100.01)が点灯しており，ランプ(Q:100.02)は消灯している．
  \item 押しボタンスイッチ(I:0.00)をONにすると，内部リレー(T0000)が動作し，自己保持回路が形成される．これにより，タイマ(TIM0000)が動作を開始する．
  \item タイマ(TIM0000)は設定時間 (1秒) を計測し，時間が経過するとその出力接点がONとなる．これにより，ランプ(Q:100.01)が消灯し，次のランプ(Q:100.02)が点灯する．同時にタイマ(TIM0001)が動作を開始する．
  \item タイマ(TIM0001)は設定時間 (1秒) を計測し，時間が経過するとその出力接点がONとなり，ランプ(Q:100.02)が消灯し，再びランプ(Q:100.01)が点灯する．
  \item その後，再びタイマ(TIM0000)が動作を開始し，上記の動作を繰り返すことで，ランプ(Q:100.01)とランプ(Q:100.02)が交互に点灯する．
  \item スイッチ(I:0.00)をOFFにすると，内部リレー(T0000)がリセットされ，自己保持回路が解除される．これにより，全てのタイマとランプが停止し，初期状態に戻る．
  \item このラダープログラムでは，スイッチを一度押すだけで，タイマを利用してランプが自動的に交互点灯する回路を実現している．初期状態でランプ(Q:100.01)が点灯している点に注意が必要である．
\end{enumerate}



\subsubsection*{課題2-4 カウンタとタイマ（課題1-4のラダープログラム）}
1秒につき1カウントする回路を作成した．
起動には押しボタンスイッチを用いた自己保持回路を用いる.
また,通常のカウンタ（CNT）は減算であるため加減算カウンタ（CNTR）を用いること.
\begin{figure}[H]
  \centering
  \includegraphics[scale=1]{sozai/2-4-crop.pdf}
  \caption{課題2-4}
\end{figure}
\begin{enumerate}
  \item 初期状態では, スイッチがOFFであり, 回路は動作を開始していない.
  \item スイッチを押すと, 自己保持回路が形成され, タイマ(TIM000)が動作を開始する.
  \item タイマ(TIM000)は設定時間を計測し, 設定時間が経過すると次のタイマ(TIM001)が動作を開始する.
  \item タイマ(TIM001)が設定時間を経過するたびに, 加減算カウンタ(CNTR012)が1カウントされる.
  \item カウンタ(CNTR012)は指定された設定値に達すると, 接点が導通し, 出力動作が完了する.
  \item スイッチをOFFにすると, 自己保持回路が解除され, 全てのタイマおよびカウンタがリセットされる.
  \item 上記の動作を繰り返すことで, スイッチ操作に応じた1秒ごとのカウント動作を確認できる.
\end{enumerate}


\subsubsection*{課題2-5 オートリセット回路（課題1-5のラダープログラム）}
設定数に達するとリセット入力を行うオートリセット回路を作成した．
出力先が指定しないのでCX-Programmer上でカウンタがリセットされていることを確認すること.
条件：自己保持回路は不要とし,カウントアップには押しボタンスイッチを用いること.
カウンタはCNTを用いること.
\begin{figure}[H]
  \centering
  \includegraphics[scale=1]{sozai/22.pdf}
  \caption{課題2-5}
\end{figure}
\begin{enumerate}
  \item 初期状態では，押しボタンスイッチ(I:0.00)がOFFであり，カウンタ(CNT0001)にはカウント信号が入力されていないため，
  カウンタはリセット状態である．
  \item 押しボタンスイッチ(I:0.00)をONにすると，入力接点が閉じ，カウンタ(CNT0001)にカウント信号が入力される．
  これにより，カウンタ値が1ずつ増加する．
  \item カウンタの現在値が設定値に達すると，カウンタのリセット信号(C0001)がONとなり，自動的にカウンタ値がリセットされる．
  \item カウンタがリセットされると，次のカウントが再び開始される．これにより，スイッチ操作に依存せずに連続的な動作が可能となる．
\end{enumerate}



\subsubsection*{課題2-6 センサとカウンタ（課題1-6のラダープログラム）}
センサを用いたアップカウンタ回路を作成した.カウンタには加減算カウンタCNTRを用いる.
\begin{figure}[H]
  \centering
  \includegraphics[scale=1]{sozai/2-6-crop.pdf}
  \caption{課題2-6}
\end{figure}

\begin{enumerate}
  \item 初期状態では，センサが動作しておらず，加減算カウンタ(CNTR)のカウント値は0である．
  \item センサがトリガされるたびに，加減算カウンタ(CNTR)が1カウント増加する．
  \item カウント値が設定値に達すると，加減算カウンタ(CNTR)の出力接点がONとなり，次の動作をトリガすることができる．
  \item 加減算カウンタ(CNTR)は内部的にカウント値を保持しており，外部リセット信号を受けるまでカウント値を保持する．
  \item リセット操作が行われると，加減算カウンタ(CNTR)は内部カウント値を0にリセットし，再びカウントを開始する準備が整う．
\end{enumerate}


\subsubsection*{課題2-7 複合課題}
押しボタンスイッチ1つのみを用いて,一度押すとランプが点灯,
もう一度押すと消灯を繰り返すラダープログラムを作成せよ.
カウンタをCNTを用いた場合のラダーフローの流れを以下に示す.ただし,CNT,
CNTRどちらを用いてもよい.CNTRを使えば,タイマによりリセットの行程を省ける.
\begin{figure}[H]
  \centering
  \includegraphics[scale=1]{sozai/2-7-crop.pdf}
  \caption{課題2-7}
\end{figure}
\begin{enumerate}
  \item 初期状態では, 押しボタンスイッチがOFFであり, ランプは消灯している.
  \item 押しボタンスイッチを1回押すと, カウンタ(CNTR)が1カウント増加し, ランプが点灯する.
  \item 再度押しボタンスイッチを押すと, カウンタがさらに1カウント増加し, ランプが消灯する.
  \item この動作を繰り返すことで, 押しボタンスイッチの操作に応じてランプが交互に点灯および消灯することを確認できる.
  \item タイマを使用した場合は, タイマの設定時間経過後にカウンタがリセットされることで同様の動作を行う.
\end{enumerate}


\subsubsection*{課題2-8 複合課題}
課題2-7を基に,押しボタンスイッチ1つでランプ2つを交互に点灯させる回路を作成した.
スイッチングする際（点灯する前）に1秒間のタイムラグを与えること.
つまり,
ランプ1点灯（X1秒）→ランプ1消灯→1秒経過→ランプ2点灯（X2秒）→ランプ2消灯→1秒経過→ランプ1点灯
の繰り返しとなる.
ここで,X秒のところは各自が押しボタンスイッチを押す間隔である.
また,スイッチを押すまではランプが点灯していないように工夫せよ.
\begin{figure}[H]
  \centering
  \includegraphics[scale=1]{sozai/2-8-crop.pdf}
  \caption{課題2-8}
\end{figure}

\begin{enumerate}
  \item 初期状態では，押しボタンスイッチ(I:0.00)がOFFであり，内部リレー(T0001)，タイマ(TIM)，およびカウンタ(CNTR012)が全てリセットされた状態である．また，ランプ(Q:100.01，Q:100.02)は消灯している．
  \item 押しボタンスイッチ(I:0.00)をONにすると，内部リレー(T0001)が動作し，自己保持回路が形成される．これにより，タイマ(TIM000)が動作を開始する．
  \item タイマ(TIM000)は設定時間 (1秒) を計測し，時間が経過するとその出力接点がONとなり，ランプ(Q:100.01)が点灯する．同時にカウンタ(CNTR012)がカウントアップを開始する．
  \item カウンタ(CNTR012)のカウント値が設定値 (例: 2) に達すると，次のタイマ(TIM001)が動作を開始し，ランプ(Q:100.01)が消灯し，ランプ(Q:100.02)が点灯する．
  \item さらにタイマ(TIM001)が設定時間 (例: 2秒) を計測した後，ランプ(Q:100.02)が消灯し，再びタイマ(TIM000)が動作を開始する．
  \item これにより，ランプ(Q:100.01)と(Q:100.02)が交互に点灯する動作が繰り返される．ただし，点灯切り替え時には1秒間のタイムラグが設けられている．
  \item スイッチ(I:0.00)をOFFにすると，内部リレー(T0001)がリセットされ，自己保持回路が解除される．これにより，タイマ，カウンタ，およびランプの動作が全て停止し，初期状態に戻る．
\end{enumerate}

